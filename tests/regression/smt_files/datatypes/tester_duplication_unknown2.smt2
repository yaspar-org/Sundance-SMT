(declare-sort FuelId 0)
(declare-fun fuel_bool (FuelId) Bool)
(declare-sort Poly 0)
(declare-fun I (Int) Poly)
(declare-fun %I (Poly) Int)
(declare-sort Type 0)
(declare-const NAT Type)
(declare-sort Dcr 0)
(declare-const $ Dcr)
(declare-fun has_type (Poly Type) Bool)
;(assert (forall ((x Int)) (! (= x (%I (I x))) :pattern ((I x)))))
(declare-const fuel%lib!spec.unbounded_log_refines_simplelog.impl&%0.get_fresh_rid. FuelId)
(declare-const fuel%lib!add_ticket. FuelId)
(declare-fun proj%lib!Dispatch./ReadOperation (Dcr Type) Type)
(declare-fun proj%lib!Dispatch./WriteOperation (Dcr Type) Type)
(declare-sort vstd!map.Map<nat./nat.>. 0)
(declare-sort vstd!map.Map<nat./lib!spec.simple_log.UpdateResp.>. 0)
(declare-sort vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. 0)
(declare-sort vstd!seq.Seq<nat.>. 0)
(declare-datatypes ((lib!spec.simple_log.SimpleLog.State. 0) (lib!spec.unbounded_log.UnboundedLog.State. 0) (lib!spec.unbounded_log.UnboundedLog.Step. 0) (lib!spec.unbounded_log.UnboundedLog.Config. 0) (lib!spec.types.LogEntry. 0) (lib!spec.simple_log.ReadReq. 0) (lib!spec.simple_log.UpdateResp. 0) (lib!spec.unbounded_log.ReadonlyState. 0) (lib!spec.unbounded_log.UpdateState. 0) (lib!spec.unbounded_log.CombinerState. 0) (lib!InputOperation. 0) (lib!OutputOperation. 0) (lib!AsyncLabel. 0) (tuple%0. 0) (tuple%2. 0) (tuple%3. 0) (tuple%4. 0)) (((lib!spec.simple_log.SimpleLog.State./State (lib!spec.simple_log.SimpleLog.State./State/?log Poly) (lib!spec.simple_log.SimpleLog.State./State/?version Int) (lib!spec.simple_log.SimpleLog.State./State/?readonly_reqs Poly) (lib!spec.simple_log.SimpleLog.State./State/?update_reqs Poly) (lib!spec.simple_log.SimpleLog.State./State/?update_resps vstd!map.Map<nat./lib!spec.simple_log.UpdateResp.>.))) ((lib!spec.unbounded_log.UnboundedLog.State./State (lib!spec.unbounded_log.UnboundedLog.State./State/?num_replicas Int) (lib!spec.unbounded_log.UnboundedLog.State./State/?log Poly) (lib!spec.unbounded_log.UnboundedLog.State./State/?tail Int) (lib!spec.unbounded_log.UnboundedLog.State./State/?replicas Poly) (lib!spec.unbounded_log.UnboundedLog.State./State/?local_versions vstd!map.Map<nat./nat.>.) (lib!spec.unbounded_log.UnboundedLog.State./State/?version_upper_bound Int) (lib!spec.unbounded_log.UnboundedLog.State./State/?local_reads Poly) (lib!spec.unbounded_log.UnboundedLog.State./State/?local_updates Poly) (lib!spec.unbounded_log.UnboundedLog.State./State/?combiner vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>.))) ((lib!spec.unbounded_log.UnboundedLog.Step./readonly_version_upper_bound (lib!spec.unbounded_log.UnboundedLog.Step./readonly_version_upper_bound/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./readonly_ready_to_read (lib!spec.unbounded_log.UnboundedLog.Step./readonly_ready_to_read/?0 Int) (lib!spec.unbounded_log.UnboundedLog.Step./readonly_ready_to_read/?1 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./readonly_apply (lib!spec.unbounded_log.UnboundedLog.Step./readonly_apply/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./update_place_ops_in_log_one (lib!spec.unbounded_log.UnboundedLog.Step./update_place_ops_in_log_one/?0 Int) (lib!spec.unbounded_log.UnboundedLog.Step./update_place_ops_in_log_one/?1 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./update_done (lib!spec.unbounded_log.UnboundedLog.Step./update_done/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_trivial_start (lib!spec.unbounded_log.UnboundedLog.Step./exec_trivial_start/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_load_local_version (lib!spec.unbounded_log.UnboundedLog.Step./exec_load_local_version/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_load_global_head (lib!spec.unbounded_log.UnboundedLog.Step./exec_load_global_head/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_dispatch_local (lib!spec.unbounded_log.UnboundedLog.Step./exec_dispatch_local/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_dispatch_remote (lib!spec.unbounded_log.UnboundedLog.Step./exec_dispatch_remote/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_update_version_upper_bound (lib!spec.unbounded_log.UnboundedLog.Step./exec_update_version_upper_bound/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_finish (lib!spec.unbounded_log.UnboundedLog.Step./exec_finish/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./exec_finish_no_change (lib!spec.unbounded_log.UnboundedLog.Step./exec_finish_no_change/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Step./dummy_to_use_type_params (lib!spec.unbounded_log.UnboundedLog.Step./dummy_to_use_type_params/?0 lib!spec.unbounded_log.UnboundedLog.State.))) ((lib!spec.unbounded_log.UnboundedLog.Config./initialize (lib!spec.unbounded_log.UnboundedLog.Config./initialize/?0 Int)) (lib!spec.unbounded_log.UnboundedLog.Config./dummy_to_use_type_params (lib!spec.unbounded_log.UnboundedLog.Config./dummy_to_use_type_params/?0 lib!spec.unbounded_log.UnboundedLog.State.))) ((lib!spec.types.LogEntry./LogEntry (lib!spec.types.LogEntry./LogEntry/?op Poly) (lib!spec.types.LogEntry./LogEntry/?node_id Int))) ((lib!spec.simple_log.ReadReq./Init (lib!spec.simple_log.ReadReq./Init/?op Poly)) (lib!spec.simple_log.ReadReq./Req (lib!spec.simple_log.ReadReq./Req/?version Int) (lib!spec.simple_log.ReadReq./Req/?op Poly))) ((lib!spec.simple_log.UpdateResp./UpdateResp (lib!spec.simple_log.UpdateResp./UpdateResp/?0 Int))) ((lib!spec.unbounded_log.ReadonlyState./Init (lib!spec.unbounded_log.ReadonlyState./Init/?op Poly)) (lib!spec.unbounded_log.ReadonlyState./VersionUpperBound (lib!spec.unbounded_log.ReadonlyState./VersionUpperBound/?op Poly) (lib!spec.unbounded_log.ReadonlyState./VersionUpperBound/?version_upper_bound Int)) (lib!spec.unbounded_log.ReadonlyState./ReadyToRead (lib!spec.unbounded_log.ReadonlyState./ReadyToRead/?op Poly) (lib!spec.unbounded_log.ReadonlyState./ReadyToRead/?version_upper_bound Int) (lib!spec.unbounded_log.ReadonlyState./ReadyToRead/?node_id Int)) (lib!spec.unbounded_log.ReadonlyState./Done (lib!spec.unbounded_log.ReadonlyState./Done/?op Poly) (lib!spec.unbounded_log.ReadonlyState./Done/?version_upper_bound Int) (lib!spec.unbounded_log.ReadonlyState./Done/?node_id Int) (lib!spec.unbounded_log.ReadonlyState./Done/?ret Poly))) ((lib!spec.unbounded_log.UpdateState./Init (lib!spec.unbounded_log.UpdateState./Init/?op Poly)) (lib!spec.unbounded_log.UpdateState./Placed (lib!spec.unbounded_log.UpdateState./Placed/?op Poly) (lib!spec.unbounded_log.UpdateState./Placed/?idx Int)) (lib!spec.unbounded_log.UpdateState./Applied (lib!spec.unbounded_log.UpdateState./Applied/?ret Poly) (lib!spec.unbounded_log.UpdateState./Applied/?idx Int)) (lib!spec.unbounded_log.UpdateState./Done (lib!spec.unbounded_log.UpdateState./Done/?ret Poly) (lib!spec.unbounded_log.UpdateState./Done/?idx Int))) ((lib!spec.unbounded_log.CombinerState./Ready) (lib!spec.unbounded_log.CombinerState./Placed (lib!spec.unbounded_log.CombinerState./Placed/?queued_ops vstd!seq.Seq<nat.>.)) (lib!spec.unbounded_log.CombinerState./LoadedLocalVersion (lib!spec.unbounded_log.CombinerState./LoadedLocalVersion/?queued_ops vstd!seq.Seq<nat.>.) (lib!spec.unbounded_log.CombinerState./LoadedLocalVersion/?lversion Int)) (lib!spec.unbounded_log.CombinerState./Loop (lib!spec.unbounded_log.CombinerState./Loop/?queued_ops vstd!seq.Seq<nat.>.) (lib!spec.unbounded_log.CombinerState./Loop/?lversion Int) (lib!spec.unbounded_log.CombinerState./Loop/?idx Int) (lib!spec.unbounded_log.CombinerState./Loop/?tail Int)) (lib!spec.unbounded_log.CombinerState./UpdatedVersion (lib!spec.unbounded_log.CombinerState./UpdatedVersion/?queued_ops vstd!seq.Seq<nat.>.) (lib!spec.unbounded_log.CombinerState./UpdatedVersion/?tail Int))) ((lib!InputOperation./Read (lib!InputOperation./Read/?0 Poly)) (lib!InputOperation./Write (lib!InputOperation./Write/?0 Poly))) ((lib!OutputOperation./Read (lib!OutputOperation./Read/?0 Poly)) (lib!OutputOperation./Write (lib!OutputOperation./Write/?0 Poly))) ((lib!AsyncLabel./Internal) (lib!AsyncLabel./Start (lib!AsyncLabel./Start/?0 Int) (lib!AsyncLabel./Start/?1 lib!InputOperation.)) (lib!AsyncLabel./End (lib!AsyncLabel./End/?0 Int) (lib!AsyncLabel./End/?1 lib!OutputOperation.))) ((tuple%0./tuple%0)) ((tuple%2./tuple%2 (tuple%2./tuple%2/?0 Poly) (tuple%2./tuple%2/?1 Poly))) ((tuple%3./tuple%3 (tuple%3./tuple%3/?0 Poly) (tuple%3./tuple%3/?1 Poly) (tuple%3./tuple%3/?2 Poly))) ((tuple%4./tuple%4 (tuple%4./tuple%4/?0 Poly) (tuple%4./tuple%4/?1 Poly) (tuple%4./tuple%4/?2 Poly) (tuple%4./tuple%4/?3 Poly)))))
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/num_replicas (lib!spec.unbounded_log.UnboundedLog.State.) Int)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/log (lib!spec.unbounded_log.UnboundedLog.State.) Poly)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/tail (lib!spec.unbounded_log.UnboundedLog.State.) Int)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/replicas (lib!spec.unbounded_log.UnboundedLog.State.) Poly)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/local_versions (lib!spec.unbounded_log.UnboundedLog.State.) vstd!map.Map<nat./nat.>.)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/version_upper_bound (lib!spec.unbounded_log.UnboundedLog.State.) Int)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (lib!spec.unbounded_log.UnboundedLog.State.) Poly)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (lib!spec.unbounded_log.UnboundedLog.State.) Poly)
(declare-fun lib!spec.unbounded_log.UnboundedLog.State./State/combiner (lib!spec.unbounded_log.UnboundedLog.State.) vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>.)
(declare-fun lib!InputOperation./Read/0 (lib!InputOperation.) Poly)
(declare-fun lib!InputOperation./Write/0 (lib!InputOperation.) Poly)
(declare-fun TYPE%lib!spec.unbounded_log.ReadonlyState. (Dcr Type) Type)
(declare-fun TYPE%lib!spec.unbounded_log.UpdateState. (Dcr Type) Type)
(declare-const TYPE%lib!spec.unbounded_log.CombinerState. Type)
(declare-fun TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. (Dcr Type) Type)
(declare-fun TYPE%lib!InputOperation. (Dcr Type) Type)
(declare-fun Poly%vstd!map.Map<nat./nat.>. (vstd!map.Map<nat./nat.>.) Poly)
(declare-fun %Poly%vstd!map.Map<nat./nat.>. (Poly) vstd!map.Map<nat./nat.>.)
(declare-fun Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>.) Poly)
(declare-fun %Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (Poly) vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>.)
(declare-fun %Poly%lib!spec.unbounded_log.UnboundedLog.State. (Poly) lib!spec.unbounded_log.UnboundedLog.State.)
(declare-fun Poly%lib!spec.unbounded_log.ReadonlyState. (lib!spec.unbounded_log.ReadonlyState.) Poly)
(declare-fun %Poly%lib!spec.unbounded_log.ReadonlyState. (Poly) lib!spec.unbounded_log.ReadonlyState.)
(declare-fun Poly%lib!spec.unbounded_log.UpdateState. (lib!spec.unbounded_log.UpdateState.) Poly)
(declare-fun %Poly%lib!spec.unbounded_log.UpdateState. (Poly) lib!spec.unbounded_log.UpdateState.)
(declare-fun Poly%lib!spec.unbounded_log.CombinerState. (lib!spec.unbounded_log.CombinerState.) Poly)
(declare-fun %Poly%lib!spec.unbounded_log.CombinerState. (Poly) lib!spec.unbounded_log.CombinerState.)
(declare-fun Poly%lib!InputOperation. (lib!InputOperation.) Poly)
(declare-fun %Poly%lib!InputOperation. (Poly) lib!InputOperation.)
;(assert (forall ((x lib!spec.unbounded_log.ReadonlyState.)) (! (= x (%Poly%lib!spec.unbounded_log.ReadonlyState. (Poly%lib!spec.unbounded_log.ReadonlyState. x))) :pattern ((Poly%lib!spec.unbounded_log.ReadonlyState. x)))))
;(assert (forall ((x lib!spec.unbounded_log.UpdateState.)) (! (= x (%Poly%lib!spec.unbounded_log.UpdateState. (Poly%lib!spec.unbounded_log.UpdateState. x))) :pattern ((Poly%lib!spec.unbounded_log.UpdateState. x)))))
;(assert (forall ((x lib!spec.unbounded_log.CombinerState.)) (! (= x (%Poly%lib!spec.unbounded_log.CombinerState. (Poly%lib!spec.unbounded_log.CombinerState. x))) :pattern ((Poly%lib!spec.unbounded_log.CombinerState. x)))))
;(assert (forall ((x Poly)) (! (=> (has_type x TYPE%lib!spec.unbounded_log.CombinerState.) (= x (Poly%lib!spec.unbounded_log.CombinerState. (%Poly%lib!spec.unbounded_log.CombinerState. x)))) :pattern ((has_type x TYPE%lib!spec.unbounded_log.CombinerState.)))))
(assert (has_type (Poly%lib!spec.unbounded_log.CombinerState. lib!spec.unbounded_log.CombinerState./Ready) TYPE%lib!spec.unbounded_log.CombinerState.))
;(assert (forall ((_queued_ops! vstd!seq.Seq<nat.>.) (_tail! Int)) (! (=> (<= 0 _tail!) (has_type (Poly%lib!spec.unbounded_log.CombinerState. (lib!spec.unbounded_log.CombinerState./UpdatedVersion _queued_ops! _tail!)) TYPE%lib!spec.unbounded_log.CombinerState.)) :pattern ((Poly%lib!spec.unbounded_log.CombinerState. (lib!spec.unbounded_log.CombinerState./UpdatedVersion _queued_ops! _tail!))))))
(assert (forall ((x lib!InputOperation.)) (! (= x (%Poly%lib!InputOperation. (Poly%lib!InputOperation. x))) :pattern ((lib!InputOperation./Read/0 x)))))
;(assert (forall ((DT&. Dcr) (DT& Type) (x Poly)) (! (=> (has_type x (TYPE%lib!InputOperation. DT&. DT&)) (= x (Poly%lib!InputOperation. (%Poly%lib!InputOperation. x)))) :pattern ((has_type x (TYPE%lib!InputOperation. DT&. DT&))))))
;(assert (forall ((x lib!InputOperation.)) (! (= (lib!InputOperation./Read/0 x) (lib!InputOperation./Read/?0 x)) :pattern ((lib!InputOperation./Write/0 x)))))
;(assert (forall ((DT&. Dcr) (DT& Type) (x Poly)) (! (=> (has_type x (TYPE%lib!InputOperation. DT&. DT&)) (has_type (lib!InputOperation./Read/0 (%Poly%lib!InputOperation. x)) (proj%lib!Dispatch./ReadOperation DT&. DT&))) :pattern ((lib!InputOperation./Write/0 (%Poly%lib!InputOperation. x)) (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&)))))
;(assert (forall ((DT&. Dcr) (DT& Type) (_0! Poly)) (! (=> (has_type _0! (proj%lib!Dispatch./WriteOperation DT&. DT&)) (has_type (Poly%lib!InputOperation. (lib!InputOperation./Write _0!)) (TYPE%lib!InputOperation. DT&. DT&))) :pattern ((has_type (Poly%lib!InputOperation. (lib!InputOperation./Write _0!)) (TYPE%lib!InputOperation. DT&. DT&))))))
;(assert (forall ((x lib!InputOperation.)) (! (= (lib!InputOperation./Write/0 x) (lib!InputOperation./Write/?0 x)) :pattern ((lib!InputOperation./Write/0 x)))))
;(assert (forall ((DT&. Dcr) (DT& Type) (x Poly)) (! (=> (has_type x (TYPE%lib!InputOperation. DT&. DT&)) (has_type (lib!InputOperation./Write/0 (%Poly%lib!InputOperation. x)) (proj%lib!Dispatch./WriteOperation DT&. DT&))) :pattern ((lib!InputOperation./Write/0 (%Poly%lib!InputOperation. x)) (proj%lib!Dispatch./ReadOperation DT&. DT&)))))
(declare-fun vstd!map.impl&%0.dom.? (Dcr Type Dcr Type Poly) Poly)
(declare-fun vstd!map.impl&%0.insert.? (Dcr Type Dcr Type Poly Poly Poly) Poly)
(declare-fun vstd!set.impl&%0.contains.? (Dcr Type Poly Poly) Bool)
(declare-fun vstd!set.impl&%0.union.? (Dcr Type Poly Poly) Poly)
(declare-fun lib!spec.unbounded_log.get_fresh_nat.? (Poly Poly) Int)
(declare-fun lib!add_ticket.? (Dcr Type Poly Poly Poly Poly) Bool)
(declare-fun lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? (Dcr Type Dcr Type Poly) Poly)
(define-fun is-lib!InputOperation./Read_ ((c lib!InputOperation.)) Bool ((_ is lib!InputOperation./Read) c))
;(assert (=> (fuel_bool fuel%lib!spec.unbounded_log_refines_simplelog.impl&%0.get_fresh_rid.) (forall ((DT&. Dcr) (DT& Type) (pre! Poly) (post! Poly) (input! Poly) (rid! Poly)) (! (= (lib!add_ticket.? DT&. DT& pre! post! input! rid!) (and (and (not (vstd!set.impl&%0.contains.? $ NAT (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))) rid!)) (not (vstd!set.impl&%0.contains.? $ NAT (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.UpdateState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))) rid!))) (ite (is-lib!InputOperation./Read_ (%Poly%lib!InputOperation. input!)) (let ((read_op$ (lib!InputOperation./Write/0 (%Poly%lib!InputOperation. pre!)))) (= (%Poly%lib!spec.unbounded_log.UnboundedLog.State. post!) (lib!spec.unbounded_log.UnboundedLog.State./State (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/num_replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/log (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/tail (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./nat.>. (Poly%vstd!map.Map<nat./nat.>. (lib!spec.unbounded_log.UnboundedLog.State./State/local_versions (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/version_upper_bound (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (vstd!map.impl&%0.insert.? $ NAT $ (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) rid! (Poly%lib!spec.unbounded_log.ReadonlyState. (lib!spec.unbounded_log.ReadonlyState./Init (lib!InputOperation./Read/0 (%Poly%lib!InputOperation. input!))))) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (lib!spec.unbounded_log.UnboundedLog.State./State/combiner (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))))))) (let ((write_op$ (lib!InputOperation./Write/0 (%Poly%lib!InputOperation. pre!)))) (= (%Poly%lib!spec.unbounded_log.UnboundedLog.State. post!) (lib!spec.unbounded_log.UnboundedLog.State./State (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/num_replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/log (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/tail (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./nat.>. (Poly%vstd!map.Map<nat./nat.>. (lib!spec.unbounded_log.UnboundedLog.State./State/local_versions (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/version_upper_bound (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (vstd!map.impl&%0.insert.? $ NAT $ (TYPE%lib!spec.unbounded_log.UpdateState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) rid! (Poly%lib!spec.unbounded_log.UpdateState. (lib!spec.unbounded_log.UpdateState./Init (lib!InputOperation./Write/0 (%Poly%lib!InputOperation. input!))))) (%Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (lib!spec.unbounded_log.UnboundedLog.State./State/combiner (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))))))))) :pattern ((lib!add_ticket.? DT&. DT& pre! post! input! rid!))))))
;(assert (=> (fuel_bool fuel%lib!spec.unbounded_log_refines_simplelog.impl&%0.get_fresh_rid.) (forall ((DT&. Dcr) (DT& Type) (pre! Poly)) (! (= (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!) (I (lib!spec.unbounded_log.get_fresh_nat.? (vstd!set.impl&%0.union.? $ NAT (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.UpdateState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))) (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (lib!spec.unbounded_log.UnboundedLog.State./State/combiner (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))))) :pattern ((lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!))))))
(declare-const DT&. Dcr)
(declare-const DT& Type)
(declare-const pre! Poly)
(declare-const post! Poly)
(declare-const input! Poly)
(assert (has_type input! (TYPE%lib!InputOperation. DT&. DT&)))
(assert (lib!add_ticket.? DT&. DT& pre! post! input! (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!)))
(assert (=> (has_type input! (TYPE%lib!InputOperation. DT&. DT&)) (= input! (Poly%lib!InputOperation. (%Poly%lib!InputOperation. input!)))))
(assert (= (lib!add_ticket.? DT&. DT& pre! post! input! (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!)) (and (and (not (vstd!set.impl&%0.contains.? $ NAT (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))) (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!))) (not (vstd!set.impl&%0.contains.? $ NAT (vstd!map.impl&%0.dom.? $ NAT $ (TYPE%lib!spec.unbounded_log.UpdateState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))) (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!)))) (ite (is-lib!InputOperation./Read_ (%Poly%lib!InputOperation. input!)) (= (%Poly%lib!spec.unbounded_log.UnboundedLog.State. post!) (lib!spec.unbounded_log.UnboundedLog.State./State (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/num_replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/log (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/tail (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./nat.>. (Poly%vstd!map.Map<nat./nat.>. (lib!spec.unbounded_log.UnboundedLog.State./State/local_versions (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/version_upper_bound (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (vstd!map.impl&%0.insert.? $ NAT $ (TYPE%lib!spec.unbounded_log.ReadonlyState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!) (Poly%lib!spec.unbounded_log.ReadonlyState. (lib!spec.unbounded_log.ReadonlyState./Init (lib!InputOperation./Read/0 (%Poly%lib!InputOperation. input!))))) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (lib!spec.unbounded_log.UnboundedLog.State./State/combiner (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))))) (= (%Poly%lib!spec.unbounded_log.UnboundedLog.State. post!) (lib!spec.unbounded_log.UnboundedLog.State./State (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/num_replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/log (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/tail (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/replicas (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (%Poly%vstd!map.Map<nat./nat.>. (Poly%vstd!map.Map<nat./nat.>. (lib!spec.unbounded_log.UnboundedLog.State./State/local_versions (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (%I (I (lib!spec.unbounded_log.UnboundedLog.State./State/version_upper_bound (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)))) (lib!spec.unbounded_log.UnboundedLog.State./State/local_reads (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (vstd!map.impl&%0.insert.? $ NAT $ (TYPE%lib!spec.unbounded_log.UpdateState. DT&. DT&) (lib!spec.unbounded_log.UnboundedLog.State./State/local_updates (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!)) (lib!UnboundedLogRefinesSimpleLog.get_fresh_rid.? $ (TYPE%lib!spec.unbounded_log_refines_simplelog.RefinementProof. DT&. DT&) DT&. DT& pre!) (Poly%lib!spec.unbounded_log.UpdateState. (lib!spec.unbounded_log.UpdateState./Init (lib!InputOperation./Write/0 (%Poly%lib!InputOperation. input!))))) (%Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (Poly%vstd!map.Map<nat./lib!spec.unbounded_log.CombinerState.>. (lib!spec.unbounded_log.UnboundedLog.State./State/combiner (%Poly%lib!spec.unbounded_log.UnboundedLog.State. pre!))))))))))
;(assert (= (%Poly%lib!InputOperation. input!) (%Poly%lib!InputOperation. (Poly%lib!InputOperation. (%Poly%lib!InputOperation. input!)))))
(check-sat)

