(set-option :auto_config false)
(set-option :smt.mbqi false)
(set-option :smt.case_split 3)
(set-option :smt.qi.eager_threshold 100.0)
(set-option :smt.delay_units true)
(set-option :smt.arith.solver 2)
(set-option :smt.arith.nl false)
(set-option :pi.enabled false)
(set-option :rewriter.sort_disjunctions false)
(declare-sort % 0)
(declare-sort P 0)
(declare-fun B (Bool) P)
(declare-fun %B (P) Bool)
(declare-sort T 0)
(declare-const O T)
(declare-sort D 0)
(declare-fun h (P T) Bool)
(declare-fun m (%) %)
(declare-fun P (%) P)
(declare-fun % (P) %)
(declare-fun %%apply%%0 (% P) P)
(declare-fun v (D T P P) Bool)
(declare-fun s (D T P) P)
(declare-fun set_membership!set_union.? (D T P P) P)
(declare-fun set_membership!set_intersection.? (D T P P) P)
(declare-const T&. D)
(declare-const T& T)
(declare-const s1! P)
(declare-const s2! P)
(declare-const s3! P)
(declare-const !!skolem_variable_0 P)
(declare-const !!skolem_variable_1 P)
(declare-const !!skolem_variable_2 P)
(declare-const !!skolem_variable_3 P)
(declare-const !!skolem_variable_4 P)
(declare-const k Bool)
(declare-const p %)
(declare-const p1 %)
(declare-const p2 %)
(declare-const p3 %)
(declare-const p4 %)
(declare-const q1 P)
(declare-const q2 P)
(declare-const q3 P)
(declare-const a1 P)
(declare-const t1 P)
(declare-const t2 P)
(declare-const t3 P)
(declare-const t4 P)
(declare-const t5 P)
(declare-const t6 P)

(declare-const s1 P)
(declare-const s2 P)


;(assert (not (h (%%apply%%0 p3 !!skolem_variable_0) O)))
;(assert (not (h (%%apply%%0 p4 !!skolem_variable_1) O)))
;(assert (not (h (%%apply%%0 p2 !!skolem_variable_2) O)))
;(assert (not (h (%%apply%%0 p1 !!skolem_variable_3) O)))
(assert (not (h a1 O)))
(declare-const a P)
(assert (not (= (v T&. T& s2 a) (v T&. T& s1 a))))
(assert (forall ((x P)) (! (= x (B (%B x))) :pattern ((h x O)))))
;adding in assertion (immediately makes it satisfiable)

(assert (= (%B (%%apply%%0 p3 a)) (v T&. T& s2 a)))
(assert (= (v T&. T& s1 a) (%B (%%apply%%0 p4 a))))
(assert (= (%B (%%apply%%0 p2 a)) (v T&. T& (s T&. T& t2) a)))
(assert (= (%B (%%apply%%0 p1 a)) (v T&. T& (s T&. T& t1) a)))
(assert (= (%B (%%apply%%0 p a)) (v T&. T& (s T&. T& t3) a)))
; note when I add take this guy out sundance goes from unknown -> unsat (but it produces the same assertion in both cases) -> super weird
; note that I thought I could get rid of all the T&. T&, but then sundance immediately goes to always unsat
(assert (= (B true) a1))
(assert (= (%%apply%%0 p4 a) (B (or (v T&. T& q2 a) (v T&. T& q1 a)))))
(assert (= (%%apply%%0 p a) (B (or (v T&. T& s2! a) (v T&. T& s3! a)))))
(assert (= q3 (s T&. T& t3))) ; note inlining this gives immediate unsat from sundance
(assert (= (%%apply%%0 p3 a) (B (and k (v T&. T& q3 a)))))
(assert (= (%%apply%%0 p2 a) (B (and k (v T&. T& s2! a)))))
(assert (= (%%apply%%0 p1 a) (B (and k (v T&. T& s3! a)))))
(assert (= q2 (s T&. T& t2))) ; note inlining this gives immediate unsat from sundance
(assert (= q1 (s T&. T& t1))) ; note inlining this gives immediate unsat from sundance
(check-sat)
